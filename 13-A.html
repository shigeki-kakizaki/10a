<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>将棋っぽく駒を動かす</title>

<style>
  body {
    font-family: system-ui, sans-serif;
    text-align: center;
  }

  .board {
    position: relative;
    width: 360px;
    height: 360px;
    margin: 20px auto;
    border: 3px solid #333;
    background:
      linear-gradient(#ccc 1px, transparent 1px),
      linear-gradient(90deg, #ccc 1px, transparent 1px);
    background-size: 40px 40px;
  }

  #piece {
    position: absolute;
    width: 40px;
    height: 40px;
    background: #d18b47;
    color: #000;
    display: grid;
    place-items: center;
    font-weight: bold;
    cursor: pointer;
  }

  .promoted {
    background: #e63946;
    color: #fff;
  }
</style>
</head>

<body>
<h1>将棋っぽい操作</h1>
<p>矢印キーで移動／クリックで「成り」</p>

<div class="board" id="board">
  <div id="piece">歩</div>
</div>

<script>
  const board = document.getElementById("board");
  const piece = document.getElementById("piece");

  let x = 160;
  let y = 320;
  const step = 40;

  function clamp(v, min, max) {
    return Math.max(min, Math.min(max, v));
  }

  function draw() {
    piece.style.left = x + "px";
    piece.style.top  = y + "px";
  }

  draw();

  // キー操作（移動）
  window.addEventListener("keydown", (e) => {
    if (["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)) {
      e.preventDefault();
    }

    if (e.key === "ArrowUp") y -= step;
    if (e.key === "ArrowDown") y += step;
    if (e.key === "ArrowLeft") x -= step;
    if (e.key === "ArrowRight") x += step;

    const maxX = board.clientWidth - piece.clientWidth;
    const maxY = board.clientHeight - piece.clientHeight;

    x = clamp(x, 0, maxX);
    y = clamp(y, 0, maxY);

    draw();
  }, { passive: false });

  // マウス操作（成る）
  piece.addEventListener("click", () => {
    piece.classList.toggle("promoted");
    piece.textContent =
      piece.classList.contains("promoted") ? "と" : "歩";
  });
</script>
</body>
</html>
